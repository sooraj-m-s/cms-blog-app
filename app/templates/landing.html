<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Blog App - Home</title>
    <link rel="stylesheet" href="/static/css/landing.css">
</head>
<body>
    <header class="header">
        <div class="logo">BlogApp</div>
        <div class="nav-buttons">
            <a href="#" class="btn btn-secondary" onclick="goToMyBlogs()">My Blogs</a>
            <button class="btn btn-primary" onclick="logout()">Logout</button>
        </div>
    </header>

    <div class="container">
        <div id="blogGrid" class="blog-grid">
            <div class="loading">Loading blogs...</div>
        </div>
        
        <div id="pagination" class="pagination" style="display: none;"></div>
    </div>

    <script>
        window.BASE_URL = '{{ base_url }}';
        
        function displayBlogs(blogs) {
            const blogGrid = document.getElementById('blogGrid');
            
            if (blogs.length === 0) {
                blogGrid.innerHTML = '<div class="loading">No blogs found.</div>';
                return;
            }

            blogGrid.innerHTML = blogs.map(blog => `
                <div class="blog-card" onclick="viewBlog(${blog.id})">
                    ${blog.image_url ? 
                        `<img src="${blog.image_url}" alt="${blog.title}" class="blog-image">` :
                        `<div class="blog-image"></div>`
                    }
                    <div class="blog-content">
                        <h3 class="blog-title">${blog.title}</h3>
                        <p class="blog-excerpt">${blog.content.substring(0, 150)}...</p>
                        <div class="blog-meta">
                            <span>Views: ${blog.read_count}</span>
                            <span>${new Date(blog.created_at).toLocaleDateString()}</span>
                        </div>
                        <div class="blog-actions" onclick="event.stopPropagation()">
                            <button class="action-btn" onclick="toggleLike(${blog.id}, this)">
                                üëç ${blog.like_count}
                            </button>
                            <button class="action-btn" onclick="toggleDislike(${blog.id}, this)">
                                üëé ${blog.dislike_count}
                            </button>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        function updatePagination(currentPage, totalPages) {
            const pagination = document.getElementById('pagination');
            
            if (totalPages <= 1) {
                pagination.style.display = 'none';
                return;
            }

            pagination.style.display = 'flex';
            let paginationHTML = '';
            
            paginationHTML += `
                <button class="page-btn" onclick="loadBlogs(${currentPage - 1})" ${currentPage === 1 ? 'disabled' : ''}>
                    Previous
                </button>
            `;
            
            for (let i = Math.max(1, currentPage - 2); i <= Math.min(totalPages, currentPage + 2); i++) {
                paginationHTML += `
                    <button class="page-btn ${i === currentPage ? 'active' : ''}" onclick="loadBlogs(${i})">
                        ${i}
                    </button>
                `;
            }
            
            paginationHTML += `
                <button class="page-btn" onclick="loadBlogs(${currentPage + 1})" ${currentPage === totalPages ? 'disabled' : ''}>
                    Next
                </button>
            `;
            
            pagination.innerHTML = paginationHTML;
        }

        window.displayBlogs = displayBlogs;
        window.updatePagination = updatePagination;
    </script>
    <script src="/static/js/landing.js"></script>
</body>
</html>